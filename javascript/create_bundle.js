// Generated by CoffeeScript 1.9.2
(function() {
  var Promise, config, create_database, db, dbDriver, dbName, insert_apiary, insert_beehouse, insert_location, insert_stand, promisify_db, usersDb;

  create_database = require('../../openbeelab-db-util/javascript/create_database');

  insert_location = require('../../openbeelab-db-util/javascript/insert_location');

  insert_apiary = require('../../openbeelab-db-util/javascript/insert_apiary');

  insert_stand = require('../../openbeelab-db-util/javascript/insert_stand');

  insert_beehouse = require('../../openbeelab-db-util/javascript/insert_beehouse');

  config = require('./config');

  dbDriver = require('../../openbeelab-db-util/javascript/dbUtil').configuredDriver(config.databases.local);

  promisify_db = require('../../openbeelab-db-util/javascript/promisify_cradle');

  dbName = config.databases.local.name;

  usersDb = dbDriver.database("_users");

  usersDb = promisify_db(usersDb);

  db = dbDriver.database(dbName);

  db = promisify_db(db);

  Promise = require("promise");

  create_database(usersDb, db, dbName).then(function(db) {
    console.log("database created.");
    return db;
  }).then(function(db) {
    var location;
    location = config.databases.local.location;
    return insert_location(db, location);
  }).then(function(arg) {
    var apiary, db, location;
    db = arg[0], location = arg[1];
    console.log("location created.");
    apiary = config.databases.local.apiary;
    return db.save(apiary).then(function() {
      return [db, apiary];
    });
  }).then(function(arg) {
    var apiary, db, p1, p2;
    db = arg[0], apiary = arg[1];
    console.log("apiary created.");
    p1 = db.save(config.databases.local.beehouse_model);
    p2 = db.save(config.databases.local.beehouse);
    return Promise.all([p1, p2]).then(function(arg1) {
      var beehouse, model;
      model = arg1[0], beehouse = arg1[1];
      return [db, apiary, beehouse];
    });
  }).then(function(arg) {
    var apiary, beehouse, db, stand;
    db = arg[0], apiary = arg[1], beehouse = arg[2];
    console.log("beehouse created.");
    stand = config.databases.local.stand;
    return db.save(stand);
  }).then(function() {
    return console.log("stand created.");
  })["catch"](function(err) {
    return console.log(err);
  });

}).call(this);
